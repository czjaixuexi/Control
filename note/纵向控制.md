# PID控制



![image-20230428233746318](https://gitee.com/czjaixuexi/typora_pictures/raw/master/img/202305092142480.png)



## 增量式PID与位置式PID

- 位置式：输出控制量，位置式算法较为简单，直接输入当前的偏差e(k) ，即可得到输出u(k) ；
- 增量式：输出控制增量，增量式算法需要保存历史偏差e(k-1),e(k-2),即在第k次控制周期时，需要使用第k-1和第k-2次控制所输入的偏差，最终计算得到$\Delta u(k)$，此时，**这还不是我们所需要的PID输出量**；所以需要进行累加；

$$
u(k) = u(k-1)+\Delta u(k)
$$

通过对比位置式PID公式和增量式PID公式，我们会发现，位置式PID公式带有积分项，而增量式PID公式没有带积分项，而什么时候用位置式PID，什么时候用增量式PID，是根据执行元件是否带积分部件来决定的，若带积分部件则使用增量式PID（增量式PID没有积分项），若不带积分部件，则使用位置式PID（位置式PID带有积分项）。

那什么是带有积分部件，什么是不带积分部件？

带有积分部件就是指执行元件有记忆性，能够记录此次的运行状态，比如步进电机，当给步进电机一个脉冲后，在下一个脉冲到来前，它都会保持在这个位置。而直流电机就是不带积分部件的执行元件，它没有记忆性，给一个脉冲，它的位置不会保持在一个固定位置，它会因为惯性继续转动。



**自动驾驶中常用位置式PID。**

### 增量式PID





<img src="https://gitee.com/czjaixuexi/typora_pictures/raw/master/img/202305092217543.png" alt="1" style="zoom:80%;" />





增量式PID控制的主要优点为：

①控制增量Δu(k)的确定仅与最近3次的采样值有关，容易通过加权处理获得比较好的控制效果；

②计算机每次只输出控制增量，即对应执行机构位置的变化量，故机器发生故障时影响范围小、不会严重影响生产过程；

③对于一些工业控制上的机器，手动到自动切换时冲击小。当控制从手动向自动切换时，可以作到无扰动切换。



### 位置式PID



<img src="https://gitee.com/czjaixuexi/typora_pictures/raw/master/img/202305092215466.png" alt="2"  />





<img src="https://gitee.com/czjaixuexi/typora_pictures/raw/master/img/202305092215467.png" alt="3"  />





## PID参数调整（位置式）



<img src="https://gitee.com/czjaixuexi/typora_pictures/raw/master/img/202305092215468.gif" alt="4"  />





<img src="https://gitee.com/czjaixuexi/typora_pictures/raw/master/img/202305092215469.png" alt="5"  />



**参数整定找最佳，从小到大顺序查，**

**先是比例后积分，最后再把微分加，**

**曲线振荡很频繁，比例度盘要放大，**

**曲线漂浮绕大湾，比例度盘往小扳，**

**曲线偏离回复慢，积分时间往下降，**

**曲线波动周期长，积分时间再加长，**

**曲线振荡频率快，先把微分降下来，**

**动差大来波动慢，微分时间应加长，**

**理想曲线两个波，前高后低四比一**，

**一看二调多分析，调节质量不会低。**

比例是回复力，积分是惯性力（有滞后性），微分是阻尼力（但是会放大噪声，可能会导致稳定性变差）

快速响应系统变化的控制任务，如速度控制，偏向D些。更慢的则偏向I些。泛泛地说，偏运动控制的更快，更偏向D些。偏过程控制的更慢，更偏向I些。中间的则如机械、动力、汽车类的，ID比较平衡。



## 纵向控制PID调参经验：

**P比例系数，对误差进行比例项的控制，P很大的话，可以加快当前值到达目标值的速度（上升时间）**，但P过大也会带来超调，实际中，由于信号的延迟，比例项P会引起超调，在仿真时可以在信号后添加延时模块，模拟真实情况。**当Kp越小时，稳态误差就越大**。通过增大Kp来减小稳态误差理论上是可行的，但是由于过大的Kp会引起系统的超调。所以我们并不能无限制的增大Kp，因此我们就需要引入一个新的控制器。**当比较接近目标时，P的控制作用就比较小了。越接近目标，P的作用越温柔**。有很多内在的或者外部的因素，使控制量发生小范围的摆动

**I积分项，为了消除稳态误差**，但是会有超调，因为一般不要求准确到达目标值，只需要满足一个精度就可以，可以添加一个很小的积分项，如果时间足够长的话，会使得稳态误差收敛到0

**D微分项，抑制超调**，在实际中，微分项很重要，降低由积分项I引起的超调会比较难，又要通过降低P来降低超调，但此时响应就会比较慢，数值微分，有提前控制的作用，比如当前的速度是6，目标的速度是10，3s后的速度是12，微分项充当10-12=-2的作用，

经验：**先调P，再调D，最后调I，一般不使用积分项，使用PD控制只要控制的精度属于一个范围就可以，因为过分的追求稳态误差就会引起超调量，为了抑制超调，就要增大D，但同时也会放大噪声，因为噪声是高频低幅的，微分项会使得伯德图的对数幅频曲线往上翘，会放大高频噪声**
